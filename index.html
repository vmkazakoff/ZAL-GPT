<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MKRobots | Prompt Practice</title>

    <link rel="icon" type="image/png" href="favicon/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="favicon/favicon.svg" />
    <link rel="shortcut icon" href="favicon/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="Prompt Practice" />
    <link rel="manifest" href="favicon/site.webmanifest" />

    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <link rel="stylesheet" href="styles/markdown.css" />
    <link rel="stylesheet" href="styles/styles.css" />
  </head>

  <body x-data="{}" class="min-h-screen bg-slate-100">
    <!-- Header -->
    <div x-data="{ html: '' }" x-init="html = await (await fetch('components/header.html')).text()" x-html="html"></div>

    <!-- Loading Indicator -->
    <div
      x-data="{ html: '' }"
      x-init="html = await (await fetch('components/preloader.html')).text()"
      x-html="html"
      x-show="Object.values($store.app.loadingStates).some(state => state)"
    ></div>

    <!-- Championship Block Component -->
    <div
      x-data="{ html: '' }"
      x-init="html = await (await fetch('components/championship-block.html')).text()"
      x-html="html"
    ></div>

    <!-- Tasks Content Container -->
    <div class="container mx-auto my-8 max-w-6xl" x-show="$store.app.tasks[$store.app.currentTaskId]?.title">
      <!-- Tasks Tab Content -->
      <div class="tab-content">
        <!-- Left & Right Column -->
        <div>
          <div class="grid grid-cols-1 gap-8 lg:grid-cols-2">
            <!-- Left Column: Task Input and AI Response -->
            <div class="flex flex-col">
              <!-- Prompt Content Block -->
              <div
                x-data="{html: ''}"
                x-init="html = await (await fetch('components/prompt-block.html')).text()"
                x-html="html"
                class="h-full"
              ></div>
            </div>

            <!-- Right Column: Feedback -->
            <div class="flex flex-col">
              <div
                x-data="{html: ''}"
                x-init="html = await (await fetch('components/feedback-block.html')).text()"
                x-html="html"
                class="h-full"
              ></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Error Display Section -->
    <div class="py-12 text-center" x-show="!($store.app.currentTaskId || $store.app.championshipId)">
      <i class="fas fa-exclamation-triangle mb-4 text-5xl text-yellow-500"></i>
      <h2 class="mb-4 text-2xl font-bold text-gray-800">Проверьте ссылку</h2>
      <p class="mx-auto max-w-md text-lg text-gray-600">
        Кажется, в ссылке отсутствует идентификатор задания или чемпионата. Пожалуйста, используйте правильную ссылку.
      </p>
      <p id="errorDetails" class="mt-2 text-gray-500"></p>
    </div>

    <!-- Auth Modal -->

    <!-- QR Modal Component -->
    <div
      x-data="{html: ''}"
      x-show="$store.app.modals.qr"
      x-init="html = await (await fetch('components/qr-modal.html')).text()"
      x-html="html"
    ></div>

    <!-- Auth Modal Component -->
    <div
      x-data="{html: ''}"
      x-show="$store.app.modals.auth"
      x-init="html = await (await fetch('components/auth-modal.html')).text()"
      x-html="html"
    ></div>

    <script src="store/store.js"></script>
  </body>
</html>
